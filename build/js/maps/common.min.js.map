{"version":3,"sources":["common.js"],"names":["lazySizes","cfg","init","customScroll","ready","document","hoverTouchEvents","navigation","homeBanner","inputs","search","setTimeout","lazy","sm","brakepoints","md","lg","xl","$","device","desktop","event","$target","type","this","removeClass","addClass","el","addEventListener","e","bg","target","style","backgroundImage","getAttribute","parentNode","checkPosition","$desktopContainer","flag","$buttons","$mobileContainer","width","window","appendTo","on","$trigger","nextArrow","autoplay","autoplaySpeed","speed","infinite","slidesToShow","slidesToScroll","arrows","$input","check","$form","console","log","each","val","email","message","value","format","phone","presence","allowEmpty","conditions","name","length","minimum","tooShort","tooLong","maximum","mask","Inputmask","clearIncomplete","namspaces","validateForm","$inputs","constraints","find","values","resault","undefined","is","key","hasClass","validate","parent","remove","append","concat","_loop","_this3","popup","open","trigger","$content","focus","mouseenter","$parent","simpleBar","getScrollElement","gradientCheck","scroll","outerHeight","offset","top","SimpleBar","$popup","$close","attr","closest","active","scrollLock","close","disablePageScroll","_this","enablePageScroll","callback","_this2","$slider","rows"],"mappings":"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","file":"../common.min.js","sourcesContent":["lazySizes.cfg.init = false;\ncustomScroll();\n\n$(document).ready(function(){\n  hoverTouchEvents();\n  navigation();\n  homeBanner();\n  inputs();\n  search();\n  popup.init();\n  //обработать изображения после инициализации слайдеров\n  setTimeout(()=>{\n    lazy();\n  },500)\n})\n\n\nconst brakepoints = {\n  sm: 576,\n  md: 768,\n  lg: 992,\n  xl: 1280\n}\n\n\n//hover/touch custom events\nfunction hoverTouchEvents() {\n  $(document).on('mouseenter mouseleave touchstart touchend mousedown mouseup contextmenu', 'a[class],button,label,input,textarea,tr,.js-touch-hover', function(event) {\n    let $target = $(this);\n    //mobile events\n    if(!device.desktop()) {\n      if(event.type=='touchstart') {\n        $target.addClass('touch');\n      } \n      else if(event.type=='touchend' || event.type=='contextmenu') {\n        $target.removeClass('touch');\n      }\n    } \n    //desktop events\n    else {\n      if(event.type=='mouseenter') {\n        $target.addClass('hover');\n      } \n      else if(event.type=='mousedown') {\n        $target.addClass('mousedown');\n      } \n      else if(event.type=='mouseup') {\n        $target.removeClass('mousedown');\n      } \n      else {\n        $target.removeClass('hover');\n        $target.removeClass('mousedown');\n      }\n    }  \n  })\n}\n//lazyload\nfunction lazy() {\n  //add lazy backgrounds\n  document.addEventListener('lazybeforeunveil', function(e){\n    let el = e.target.tagName,\n        bg = e.target.getAttribute('data-src'),\n        parent = e.target.parentNode;\n\n    if(el!=='IMG') {\n      let bg = e.target.getAttribute('data-src');\n      e.target.style.backgroundImage = 'url(' + bg + ')';\n    }\n  });\n  lazySizes.init();\n}\n\nfunction navigation() {\n  let flag;\n  \n  function checkPosition() {\n    let $buttons = $('.header__buttons-group'),\n        $mobileContainer = $('.header__top .container'),\n        $desktopContainer = $('.header__bottom .container');\n\n    if($(window).width()<brakepoints.md && !flag) {\n      $buttons.appendTo($mobileContainer);\n      flag = true;\n    } \n    else if($(window).width()>=brakepoints.md && flag) {\n      $buttons.appendTo($desktopContainer);\n      flag = false;\n    }\n  }\n\n  checkPosition();\n  $(window).on('resize', function() {\n    checkPosition();\n  })\n}\n\nwindow.popup = {\n  init: function() {\n    this.$trigger = $('[data-popup-open]');\n    this.$close = $('[data-popup-close]')\n\n    this.$trigger.on('click', function(event) {\n      event.preventDefault();\n      let $popup = $($(this).attr('href'));\n      if($popup.length) {\n        popup.open($popup);\n      }\n    })\n\n    $(document).on('click', function(event) {\n      let $target = $(event.target);\n      if(\n        ($target.closest(popup.$close).length) ||\n        ($target.closest('.popup').length && $target.closest('.popup-block__container').length==0)\n      ) \n      {\n        console.log('++')\n        event.preventDefault();\n        let $popup = $target.closest('.popup').length ? $target.closest('.popup') : $('.city-question-popup');\n        popup.close($popup);\n      }\n    })\n\n  }, \n  open: function($popup) {\n    let event = () => {\n      this.active = $popup;\n      scrollLock.disablePageScroll();\n      $popup.addClass('active');\n    }\n\n    if(this.active) {\n      popup.close(this.active, function() {\n        event();\n      });\n    } else {\n      event();\n    }\n\n  }, \n  close: function($popup, callback) {\n    scrollLock.enablePageScroll();\n    $popup.removeClass('active');\n    setTimeout(()=>{\n      this.active = undefined;\n      typeof callback === 'function' && callback();\n    }, 250)\n  }\n}\n\nfunction homeBanner() {\n  let $slider = $('.home-banner');\n\n  $slider.slick({\n    rows: 0,\n    speed: 500,\n    infinite: true,\n    slidesToShow: 1,\n    slidesToScroll: 1,\n    arrows: true,\n    nextArrow: '<button class=\"home-banner__arrow home-banner__next\" aria-label=\"Next\" type=\"button\"><svg viewBox=\"0 0 15 26\"><path d=\"M1.99869 0.292969L0.584473 1.70718L11.8774 13.0001L0.584472 24.293L1.99869 25.7072L14.7058 13.0001L1.99869 0.292969Z\"/></svg></button>',\n    prevArrow: '<button class=\"home-banner__arrow home-banner__prev\" aria-label=\"Previous\" type=\"button\"><svg viewBox=\"0 0 15 26\"><path d=\"M13.286 0.292969L14.7002 1.70718L3.4073 13.0001L14.7002 24.293L13.286 25.7072L0.578877 13.0001L13.286 0.292969Z\"/></svg></button>',\n    dots: true,\n    autoplay: true,\n    autoplaySpeed: 5000\n  });\n}\n\nfunction inputs() {\n  let $form = $('.js-validation'),\n      $input = $('input, textarea');\n\n\n  $input.on('focus', function() {\n    $(this).addClass('focused');\n  })\n  $input.on('blur', function() {\n    $(this).removeClass('focused');\n  })\n  $input.on('input change', function() {\n    check();\n  })\n  function check() {\n    console.log('check')\n    $input.each(function() {\n      let value = $(this).val();\n      if(value=='') {\n        $(this).removeClass('filled');\n      } else {\n        $(this).addClass('filled');\n      }\n    })\n  }\n  check();\n      \n  let namspaces = {\n    phone: '[name=\"phone\"]',\n    email: '[name=\"email\"]',\n    name: '[name=\"name\"]',\n    message: '[name=\"message\"]'\n  },\n  conditions = {\n    phone: {\n      format: {\n        pattern: /^\\+7 \\d{3}\\ \\d{3}\\-\\d{4}$|()/,\n        message: '^Некорректный номер телефона'\n      },\n      presence: {\n        allowEmpty: false,\n        message: '^Введите номер телефона'\n      }\n    },\n    email: {\n      email: {\n        message: '^Неправильный формат. Попробуйте что-то с @'\n      }\n    },\n    name: {\n      presence: {\n        allowEmpty: false,\n        message: '^Введите ваше имя'\n      },\n      length: {\n        minimum: 2,\n        tooShort: \"^Имя слишком короткое (минимум %{count} символа)\",\n        maximum: 20,\n        tooLong: \"^Имя слишком длинное (максимум %{count} символов)\"\n      }\n    },\n    message: {\n      length: {\n        maximum: 200,\n        tooLong: \"^Сообщение слишком длинное (максимум %{count} символов)\"\n      }\n    }\n  },\n  mask = Inputmask({\n    mask: \"+7 999 999-9999\",\n    showMaskOnHover: false,\n    clearIncomplete: false\n  }).mask(namspaces.phone);\n\n  //validation events\n  $form.each(function() {\n    let $form = $(this),\n        $inputs = $form.find('input, textarea');\n\n    $inputs.on('input', function() {\n      setTimeout(()=>{\n        validateForm($(this));\n      }, 100)\n    })\n\n    function validateForm($input) {\n      let values = {};\n      let constraints = {};\n\n      $inputs.each(function() {\n        let $input = $(this);\n        for(let key in namspaces) {\n          if($input.is(namspaces[key]) && ($(this).hasClass('required') || $(this).hasClass('filled'))) {\n            values[key] = $input.val();\n            constraints[key] = conditions[key];\n          }\n        }\n      })\n\n      let resault = validate(values, constraints);\n\n      console.log(resault)\n\n      if(resault!==undefined) {\n        if($input!==undefined) {\n          let flag=true;\n          for(let key in resault) {\n            if($input.is(namspaces[key]) && ($input.hasClass('required') || $input.hasClass('filled'))) {\n              flag=false;\n            }\n          }\n          if(flag) {\n            $input.removeClass('error');\n          }\n        } else {\n          $inputs.removeClass('error');\n          $inputs.parent().find('.input__message').remove();\n          for(let key in resault) {\n            $inputs.each(function() {\n              let $input = $(this);\n              if($input.is(namspaces[key]) && ($input.hasClass('required') || $input.hasClass('filled'))) {\n                $input.addClass('error');\n                $input.parent().append(`<span class=\"input__message\">${resault[key][0]}</span>`);\n              }\n            })\n          }\n        }\n        return false;\n      } else {\n        $inputs.removeClass('error');\n        $inputs.parent().find('.input__message').remove();\n        return true;\n      }\n    }\n\n    $form.on('submit', function(event) {\n      event.preventDefault();\n      if(validateForm()) {\n        console.log('submit!');\n        $inputs.val('').trigger('change');\n        popup.open($('#succes'));\n      }\n    })\n\n  })\n}\n\nfunction search() {\n  let $parent = $('.header-search'),\n      $input = $parent.find('.header-search__input'),\n      $content = $parent.find('.header-search__content'),\n      focus = false,\n      mouseenter = false;\n\n  $input.on('input', function() {\n    let val = $(this).val();\n    if(val!=='') {\n      $parent.addClass('active').addClass('active-content');\n    } else {\n      $parent.removeClass('active').removeClass('active-content');\n    }\n  })\n\n  $content.on('mouseenter mouseleave', function(event) {\n    if(event.type=='mouseenter') {\n      mouseenter=true;\n    } else {\n      mouseenter=false;\n      if(!focus) {\n        $parent.removeClass('active-content');\n      }\n    }\n  })\n\n  $input.on('blur focus input', function(event) {\n    if(event.type=='blur') {\n      focus = false;\n      if(!mouseenter) {\n        $parent.removeClass('active-content');\n      }\n    } else if(event.type=='focus' || event.type=='input') {\n      focus = true;\n      let val = $(this).val();\n      if(val!=='') {\n        $parent.addClass('active').addClass('active-content');\n      } else {\n        $parent.removeClass('active').removeClass('active-content');\n      }\n    }\n  })\n\n}\n\nfunction customScroll() {\n  let $containers = document.querySelectorAll('.scrollbar');\n  $containers.forEach(($target)=>{\n    let $parent = $($target),\n        $content = $parent.find('.scrollbar__content'),\n        simpleBar = new SimpleBar($target);\n    \n    simpleBar.getScrollElement().addEventListener('scroll', function() {\n      gradientCheck();\n    });\n    gradientCheck();\n    \n    function gradientCheck() {\n      let scrollHeight = $content.outerHeight() - $parent.outerHeight(),\n          scroll = $parent.offset().top - $content.offset().top;\n\n      if(scroll > 0) {\n        $parent.removeClass('scrollbar_start')\n      } else {\n        $parent.addClass('scrollbar_start')\n      }\n      if(scroll < scrollHeight) {\n        $parent.removeClass('scrollbar_end')\n      } else {\n        $parent.addClass('scrollbar_end')\n      }\n    }\n\n  })\n}\n\n"]}